!function(i){"use strict";i(document).ready(function(){jQuery().niceSelect&&i(".youzer select").not('[multiple="multiple"]').niceSelect(),i(document).on("click",".yz-upload-photo",function(e){e.preventDefault();var o=i(this).closest(".yz-uploader-item");o.find(".yz_upload_file").attr("data-source",i("input[name=yz_widget_source]").val()),o.find(".yz_upload_file").attr("data-user-id",i("input[name=yz_widget_user_id]").val()),o.find(".yz_upload_file").trigger("click")}),i(document).on("change",".yz_upload_file",function(e){e.stopPropagation();var o=new FormData,t=i(this),a=i(this).closest(".yz-uploader-item"),n=a.find(".yz-photo-preview"),r=a.find(".yz-photo-url").val();o.append("nonce",i(this).closest("form").find("input[name='security']").val()),o.append("file",i(this)[0].files[0]),o.append("user_id",i(this).attr("data-user-id")),o.append("source",i(this).attr("data-source")),o.append("action","upload_files"),i.ajax({url:Youzer.ajax_url,type:"POST",data:o,contentType:!1,cache:!1,processData:!1,beforeSend:function(){i('<div class="yz-load-photo"><i class="fas fa-spinner fa-spin"></i></div>').hide().appendTo(n).fadeIn(800)},success:function(e){t.val("");var o=i.parseJSON(e);if(o.error)return n.find(".yz-load-photo").fadeOut(300).remove(),void i.yz_DialogMsg("error",o.error);r&&i.yz_DeletePhoto(r),n.find(".yz-load-photo").fadeOut(300,function(){i(this).remove(),n.fadeOut(100,function(){i(this).css("background-image","url("+o.url+")").fadeIn(400),a.find(".yz-photo-url").val(o.attachment_id).change(),a.find(".yz-delete-photo").addClass("yz-show-trash"),i.post(Youzer.ajax_url,a.closest("form").serialize()+"&die=true")})})}})}),i(".yz-account-menu").on("click",function(e){var o=i(this).next(".yz-account-menus");o.hasClass("yz-show-account-menus")&&o.removeClass("yz-show-account-menus").css("display","block"),i(this).next(".yz-account-menus").slideToggle()}),i(document).on("click",".yz-delete-photo",function(e){var o=i(this).closest(".yz-uploader-item");i.yz_DeletePhoto(o.find(".yz-photo-url").val()),o.find(".yz-photo-url").val("").trigger("change"),o.find(".yz-photo-preview").css("background-image","url("+Yz_Account.default_img+")"),i(this).removeClass("yz-show-trash"),i.post(Youzer.ajax_url,o.closest("form").serialize()+"&die=true")}),i.yz_DeletePhoto=function(e){var o=new FormData;o.append("attachment_id",e),o.append("action","yz_delete_attachment"),i.ajax({type:"POST",data:o,url:Youzer.ajax_url,contentType:!1,processData:!1})},i(".yz-account-photo .yz-photo-url").on("change",function(e){e.preventDefault();var o=i(this).val();o||(o=Yz_Account.default_img),i(".yz-account-img").fadeOut(200,function(){i(this).css("background-image","url("+o+")").fadeIn(200)})}),i(".yz-user-provider-unlink").on("click",function(e){if(e.preventDefault(),i(this).hasClass("loading"))return!1;var t=i(this).closest(".yz-user-provider-connected"),a=i(this);a.addClass("loading");var o={action:"yz_unlink_provider_account",provider:i(this).data("provider"),security:i(this).data("nonce")};i.post(ajaxurl,o,function(e){var o=i.parseJSON(e);return o.error?(a.removeClass("loading"),i.yz_DialogMsg("error",o.error),!1):o.action?(a.removeClass("loading"),t.find(".yz-user-provider-token").val(""),t.find(".yz-user-provider-box").remove(),t.removeClass().addClass("yz-user-provider-unconnected"),i.yz_DialogMsg("success",o.msg),!1):void 0}).fail(function(e,o,t){return a.removeClass("loading"),i.yz_DialogMsg("error",Youzer.unknown_error),!1})})})}(jQuery);