!function(y){"use strict";y(document).ready(function(){var l,e=!1;y(".yzw-form-show-all").on("click",function(e){y(".yzw-form-show-all").fadeOut(function(){y(".yz-wall-opts-item").fadeIn(),y(this).remove()})}),y(document).on("input click",".yz-wall-textarea, .ac-input",function(){y(this).next(".yz-load-emojis").attr("data-cursor",y(this).prop("selectionStart"))}),y(document).on("focus",".yz-wall-textarea",function(){0==e&&(y(this).closest("form").find(".yz-lp-prepost").get(0)&&(y("<link/>",{rel:"stylesheet",href:Youzer.assets+"css/yz-url-preview.min.css"}).appendTo("head"),y("<script/>",{rel:"text/javascript",src:Youzer.assets+"js/yz-url-preview.min.js"}).appendTo("head")),e=!0)}),y(document).on("click",".yz-load-emojis",function(){y(this).closest("form");y(this).find("i").attr("class","fas fa-spin fa-spinner"),y(this).addClass("loading"),y("<link/>",{rel:"stylesheet",href:Youzer.assets+"css/emojionearea.min.css"}).appendTo("head"),y("<script/>",{rel:"text/javascript",src:Youzer.assets+"js/emojionearea.min.js"}).appendTo("head")}),y(document).on("click",".yz-wall-post",function(){var e,l=0,o=y(this),d=y(this).text(),r=o.closest("form#yz-wall-form"),c={};y.each(r.serializeArray(),function(e,t){"_"!==t.name.substr(0,1)&&"whats-new"!==t.name.substr(0,9)&&(c[t.name]?y.isArray(c[t.name])?c[t.name].push(t.value):c[t.name]=new Array(c[t.name],t.value):c[t.name]=t.value)}),r.find("*").each(function(){(y.nodeName(this,"textarea")||y.nodeName(this,"input"))&&y(this).prop("disabled",!0)}),r.find(".yz-wall-textarea").get(0).emojioneArea&&r.find(".yz-wall-textarea").data("emojioneArea").disable(),o.addClass("loading"),o.prop("disabled",!0),r.addClass("submitted"),o.css("min-width",o.css("width")),o.html('<i class="fas fa-spinner fa-spin"></i>');var t="",a=r.find("#whats-new-post-in").val(),i=r.find("#whats-new").val(),f=y("#youzer ul.activity-list li").first(),s=f,n=null;return f.length&&(s.hasClass("load-newest")&&(s=f.next()),n=s.prop("class").match(/date-recorded-([0-9]+)/)),n&&(l=n[1]),0<a&&(t=r.find("#whats-new-post-object").val()),e=y.extend({action:"yz_post_update",cookie:bp_get_cookies(),_yz_wpnonce_post_update:y("#_yz_wpnonce_post_update").val(),content:i,object:t,item_id:a,since:l,_bp_as_nonce:y("#_bp_as_nonce").val()||""},c),y.post(ajaxurl,e,function(e){if(r.find("*").each(function(){(y.nodeName(this,"textarea")||y.nodeName(this,"input"))&&y(this).prop("disabled",!1)}),r.find(".yz-wall-textarea").get(0).emojioneArea&&r.find(".yz-wall-textarea").data("emojioneArea").enable(),y.yz_isJSON(e)){var t=y.parseJSON(e);y.yz_DialogMsg("error",t.error)}else{if(o.html('<i class="fas fa-check"></i>').hide().fadeIn("slow"),r.find(".yz-delete-attachment").trigger("click"),0===y("ul.activity-list").length&&(y("div.error").slideUp(100).remove(),y("#message").slideUp(100).remove(),y("div.activity").append('<ul id="activity-stream" class="activity-list item-list">')),f.hasClass("load-newest")&&f.remove(),y("#activity-stream").prepend(e),l||y("#activity-stream li:first").addClass("new-update just-posted"),y(e).get(0)&&y("body,html").animate({scrollTop:y("#"+y(e).attr("id")).offset().top-65+"px"},1e3),0!==y("#latest-update").length){var a=y("#activity-stream li.new-update .activity-content .activity-inner p").html(),i=y("#activity-stream li.new-update .activity-content .activity-header p a.view").attr("href"),s=y("#activity-stream li.new-update .activity-content .activity-inner p").text(),n="";""!==s&&(n=a+" "),n+='<a href="'+i+'" rel="nofollow">'+BP_DTheme.view+"</a>",y("#latest-update").slideUp(300,function(){y("#latest-update").html(n),y("#latest-update").slideDown(300)})}y("li.new-update").hide().slideDown(300),y("li.new-update").removeClass("new-update"),y("#whats-new").val(""),"activity_slideshow"==c.post_type&&y.youzer_sliders_init(),r.get(0).reset(),r.find(".yz-wall-textarea").get(0).emojioneArea&&r.find(".yz-wall-textarea").get(0).emojioneArea.setText(""),r.find(".yz-tagged-user .yz-tagusers-delete-user, .yz-list-delete-item, .yz-list-close-icon").trigger("click"),r.find("div.yz-activity-privacy").find(".list div").first().trigger("click"),r.find("#whats-new-post-in").find("option").first().trigger("click"),window.hasOwnProperty("yz_disable_niceselect")||r.find("#whats-new-post-in").niceSelect("update"),y("#whats-new-post-in").trigger("change"),r.find('.yz-wall-options input:radio[name="post_type"]').first().trigger("change"),r.find(".yz-lp-prepost .lp-button-cancel").trigger("click"),"activity_giphy"==c.post_type&&(r.find(".yz-delete-giphy-item").trigger("click"),r.find(".yz-giphy-submit-search").val("").trigger("click")),newest_activities="",activity_last_recorded=0}setTimeout(function(){o.html(d).fadeIn("slow")},1e3),r.find(".yz-wall-post,.yz-update-post").prop("disabled",!1).removeClass("loading"),"youzer-share-activity-wrapper"==r.parent().attr("id")&&y(".yz-modal-close-icon").trigger("click")}),!1}),y(document).on("change",'input:radio[name="post_type"]',function(){var e=y(this).closest("form"),t=y(this).val(),a=y(this).data("uploader");1<y('input:radio[name="post_type"]').length?0==e.find('.yz-wall-custom-form[data-post-type!="'+t+'"]').length?e.find('.yz-wall-custom-form[data-post-type="'+t+'"]').fadeIn():e.find('.yz-wall-custom-form[data-post-type!="'+t+'"]').fadeOut(1,function(){e.find('.yz-wall-custom-form[data-post-type="'+t+'"]').fadeIn()}):e.find('.yz-wall-custom-form[data-post-type="'+t+'"]').fadeIn(),"activity_video"==t?e.find(".yz-upload-attachments").attr("accept","video/*"):"activity_audio"==t?e.find(".yz-upload-attachments").attr("accept","audio/*"):"activity_file"==t?e.find(".yz-upload-attachments").removeAttr("accept"):e.find(".yz-upload-attachments").attr("accept","image/*"),"on"==a?("activity_quote"!=t&&"activity_link"!=t&&"youzer-edit-activity-wrapper"!=e.parent().attr("id")&&e.find(".yz-wall-actions .yz-wall-upload-btn").trigger("click"),e.find(".yz-wall-actions .yz-wall-upload-btn").fadeIn()):e.find(".yz-wall-actions .yz-wall-upload-btn").fadeOut(),e.find('.yz-wall-custom-form[data-post-type="'+t+'"]').find('input[type="text"]')[0]&&e.find('.yz-wall-custom-form[data-post-type="'+t+'"]').find('input[type="text"]')[0].focus(),e.find(".yz-attachment-item").remove()}),y('input:radio[name="post_type"]').first().trigger("change"),y(document).on("click",".yz-wall-upload-btn",function(e){yz_load_attachments||(y("<script/>",{rel:"text/javascript",src:Youzer.assets+"js/yz-attachments.min.js"}).appendTo("head"),y("<link/>",{rel:"stylesheet",href:Youzer.assets+"css/yz-attachments.min.css"}).appendTo("head"),yz_load_attachments=!0),y(this).closest("form").find(".yz-upload-attachments").click(),e.preventDefault()}),y(document).on("click",".yz-tag-users-tool",function(){var i=y(this).closest("form");if(i.find(".yz-feeling-form").fadeOut(),y(this).hasClass("loaded"))return i.find(".yz-tagusers-form").fadeToggle(),void i.find(".yz-tagusers-search-input").focus();var s=y(this),n=s.find("i"),l=n.attr("class");n.attr("class","fas fa-spinner fa-spin"),y.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"yz_tag_users_get_user_friends"},success:function(e){s.addClass("loaded");var t=y("<div></div>").append(e.data);if("youzer-edit-activity-wrapper"==i.parent().attr("id")){var a=[];i.find('input[name="tagged_users[]"]').each(function(){t.find('.yz-list-item[data-user-id="100"] ').fadeOut(),a.push(y(this).val())}),t.find(".yz-list-item").each(function(e,t){-1!==jQuery.inArray(y(this).attr("data-user-id"),a)&&y(this).find(".yz-wall-tag-user").hide()})}i.find(".yz-tagusers-form").fadeIn(200,function(){n.attr("class",l),i.find(".yz-tagusers-search-input").focus(),i.find(".yz-wall-tagusers-list").html(t)})}})}),y(document).on("keyup",".yz-list-search-input",function(){var e=y(this).closest(".yz-wall-list"),t=this.value.toLowerCase().trim();e.find(".yz-wall-list-items .yz-list-item").show().filter(function(){return-1==y(this).find(".yz-item-title, .yz-item-description").text().toLowerCase().trim().indexOf(t)}).hide()}),y(document).on("click",".yz-user-mood-tool",function(){var t=y(this).closest("form");if(t.find(".yz-tagusers-form").fadeOut(),y(this).hasClass("loaded"))return t.find(".yz-feeling-form").fadeToggle(),void t.find(".yz-feeling-search-input").focus();t.find(".yz-feeling-form").attr("data-placeholder",t.find(".yz-feeling-search-input").attr("placeholder"));var a=y(this),i=a.find("i"),s=i.attr("class");i.attr("class","fas fa-spinner fa-spin"),y.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"yz_feeling_activity_get_categories"},success:function(e){a.addClass("loaded"),t.find(".yz-feeling-form").fadeIn(200,function(){i.attr("class",s),t.find(".yz-feeling-search-input").focus(),t.find(".yz-wall-feeling-list").html(e.data)})}})}),y(document).on("click",".yz-feeling-item",function(e){e.preventDefault();var t=y(this),a=t.closest(".yz-wall-feeling");if(y(this).parent().hasClass("yz-list-category-items"))y.yz_select_mood_emojis(a,t.attr("data-emoji"),t.attr("data-category-title"),t.find(".yz-item-img").css("background-image"));else{a.find(".yz-list-items-title").text(t.attr("data-category-title")),a.find('input[name="mood_type"]').val(t.attr("data-category")),a.find(".yz-list-categories").fadeOut(),a.find(".yz-feeling-close-icon").addClass("yz-feeling-go-back"),a.find(".yz-feeling-close-icon i").attr("class","far fa-arrow-alt-circle-left"),a.find('input[name="mood_search"]').val("").attr("placeholder",t.find(".yz-item-description").text()),a.find(".yz-list-search-icon i").attr("class",t.find(".yz-item-icon i").attr("class"));var i=a.find('.yz-list-category-items[data-category="'+y(this).attr("data-category")+'"]');1==i.length?i.fadeIn():a.find(".yz-list-submit-button").fadeIn()}}),y(document).on("click",".yz-feeling-close-icon",function(){var e=y(this),t=e.closest(".yz-wall-feeling");if(t.find(".yz-feeling-submit-button").fadeOut(),t.find(".yz-feeling-search-input").val(""),t.find(".yz-feeling-search-input").attr("placeholder",t.find(".yz-feeling-form").attr("data-placeholder")),t.find(".yz-feeling-search-icon i").attr("class","fas fa-search"),e.hasClass("yz-feeling-go-back"))return e.find("i").attr("class","fas fa-times"),t.find(".yz-list-categories, .yz-list-item").fadeIn(),t.find(".yz-list-category-items").fadeOut(),void e.removeClass("yz-feeling-go-back");e.closest(".yz-feeling-form").fadeOut()}),y(document).on("click",".yz-wall-feeling .yz-list-edit-item",function(){var e=y(this),t=e.closest(".yz-wall-feeling"),a=t.find(".yz-list-selected-items");a.fadeOut(200,function(){t.find(".yz-feeling-search-input").val(a.find(".yz-item-title").text()),e.closest(".yz-selected-item").fadeOut(200,function(){y(this).remove()}),t.find(".yz-feeling-form").fadeIn(),t.removeClass("yz-activity-feeling-selected")})}),y(document).on("click",".yz-wall-feeling .yz-list-delete-item",function(){var e=y(this),t=e.closest(".yz-wall-feeling"),a=t.find(".yz-list-selected-items");a.fadeOut(200,function(){a.find(".yz-item-title").text(""),e.closest(".yz-selected-item").fadeOut(200,function(){y(this).remove()}),t.find(".yz-feeling-close-icon").trigger("click"),t.removeClass("yz-activity-feeling-selected")})}),y(document).on("click",".yz-feeling-submit-button",function(){var e=y(this).closest(".yz-wall-feeling"),t=e.find(".yz-feeling-search-input").val();""!=t.trim()&&y.yz_select_mood_emojis(e,t,t)}),y(document).on("keypress",".yz-feeling-search-input",function(e){if(13==e.keyCode){e.preventDefault();var t=y(this).next(".yz-feeling-submit-button");"none"!=t.css("display")&&t.click()}}),y.yz_select_mood_emojis=function(e,t,a,i){e.hasClass("yz-activity-feeling-selected")&&e.find(".yz-selected-item").remove(),e.addClass("yz-activity-feeling-selected"),e.find(".yz-feeling-form").fadeOut(0,function(){e.find(".yz-feeling-selected-items").fadeIn()});var s=null==i?"":"<div class='yz-item-img' style='background-image: "+i+";'></div>",n=null==i?" yz-selected-item-no-image":"";e.find(".yz-list-selected-items").append('<div class="yz-selected-item yz-feeling-selected-item'+n+'">'+s+'<div class="yz-item-title">'+a+'</div><i class="fas fa-pencil-alt yz-selected-item-tool yz-list-edit-item"></i><i class="fas fa-trash-alt yz-selected-item-tool yz-list-delete-item"></i><input type="hidden" name="mood_value" value="'+t+'"></div>').fadeIn(),e.find(".yz-feeling-search-input").val("")},y(document).on("click",".yz-wall-tag-user",function(){var a=y(this);if(!a.hasClass("yz-selected")){a.addClass("yz-selected");var i=a.closest(".yz-list-item");y(this).fadeOut(200,function(){var e="<div class=\"yz-selected-item yz-tagged-user\"><div class='yz-item-img' style='background-image: "+i.find(".yz-item-img").css("background-image")+';\'></div><div class="yz-item-title">'+i.find(".yz-item-title").text()+'</div><i class="fas fa-trash-alt yz-selected-item-tool yz-list-delete-item yz-tagusers-delete-user" data-user-id="'+i.attr("data-user-id")+'"></i><input type="hidden" name="tagged_users[]" value="'+i.attr("data-user-id")+'"></div>';i.closest(".yz-wall-tagusers").find(".yz-tagged-users").append(e);a.closest(".yz-wall-tagusers").find(".yz-tagged-user").length;var t=a.closest(".yz-wall-tagusers");1==t.find(".yz-tagged-user").length&&t.find(".yz-tagged-users").fadeIn()})}}),y(document).on("click",".yz-list-close-icon.yz-tagusers-close-icon",function(){y(this).closest(".yz-tagusers-form").fadeOut()}),y(document).on("click",".yz-tagusers-delete-user",function(){y(this).parent();var e=y(this).closest(".yz-wall-tagusers"),t=y(this).closest(".yz-tagged-users");e.find(".yz-list-item[data-user-id="+y(this).attr("data-user-id")+"] .yz-wall-tag-user").removeClass("yz-selected").fadeIn(),y(this).parent().fadeOut(200,function(){y(this).remove(),0==t.find(".yz-tagged-user").length&&t.fadeOut()})}),y(document).on("change","#whats-new-post-in",function(e){0!=y(this).val()?y(this).closest(".yz-wall-actions").find("div.yz-activity-privacy").fadeOut():y(this).closest(".yz-wall-actions").find("div.yz-activity-privacy").fadeIn()}),y(document).on("click",".yz-send-comment",function(e){if(e.preventDefault(),!y(this).hasClass("loading")){var i,s,t,a,n,l,o,d,r,c,f=y(this);return f.addClass("loading"),c=f.find("i").attr("class"),f.find("i").attr("class","fas fa-spinner fa-spin"),t=(i=f.parents("form")).parent(),n=i.attr("id").split("-"),a=t.hasClass("activity-comments")?n[2]:t.attr("id").split("-")[1],s=y("#"+i.attr("id")+" textarea"),y("#"+i.attr("id")+" div.error").hide(),f.addClass("loading").prop("disabled",!0),s.addClass("loading").prop("disabled",!0),l={action:"new_activity_comment",cookie:bp_get_cookies(),_wpnonce_new_activity_comment:y("#_wpnonce_new_activity_comment").val(),comment_id:a,form_id:n[2],post_type:"activity_comment",content:s.val()},(o=y("#_bp_as_nonce_"+a).val())&&(l["_bp_as_nonce_"+a]=o),y.post(ajaxurl,l,function(t){if(f.removeClass("loading"),s.removeClass("loading"),f.find("i").attr("class",c),t[0]+t[1]==="-1")i.append(y(t.substr(2,t.length)).hide().fadeIn(200));else{var a=i.parent();i.fadeOut(200,function(){0===a.children("ul").length&&(a.hasClass("activity-comments")?a.prepend("<ul></ul>"):a.append("<ul></ul>"));var e=y.trim(t);a.children("ul").append(y(e).hide().fadeIn(200)),i.children("textarea").val(""),a.parent().addClass("has-comments")}),y("#"+i.attr("id")+" textarea").val(""),d=Number(y("#activity-"+n[2]+" a.acomment-reply span").html())+1,y("#activity-"+n[2]+" a.acomment-reply span").html(d),(r=a.parents(".activity-comments").find(".show-all a"))&&r.html(BP_DTheme.show_x_comments.replace("%d",d))}y(f).prop("disabled",!1),y(s).prop("disabled",!1)}),!1}}),y(document).on("keypress",".ac-form textarea",function(e){13!=e.which||e.shiftKey||(e.preventDefault(),y(this).closest("form").find(".yz-send-comment").click())}),y.yz_isPostType=function(e,t){return t==e.find('input:radio[name="post_type"]:checked').val()},y(document).on("click",".share-activity",function(e){if(e.preventDefault(),!y(".share-activity.loading")[0]){var s=y(this),t=s.parents("li").attr("id").split("-")[1],n=(s.attr("data-activity-type"),!0);if(!s.hasClass("loading")){s.addClass("loading"),l=s,y("#youzer-edit-activity-wrapper");var a={action:"yz_get_share_activity_form",yz_share_activity_nonce:Youzer.security_nonce,activity_id:t};y.post(Youzer.ajax_url,a,function(e){if(0==e.success)return l.remove(),void y.yz_DialogMsg("error",e.error);var t=y(e.data.form);y("body").append(t.hide());var a=y(e.data.preview);a.insertAfter(t.find("textarea#whats-new")),jQuery.isFunction(y.fn.niceSelect)&&t.find('select:not([multiple="multiple"])').niceSelect(),150<a.height()&&(a.find(".yz-shared-wrapper-container").addClass("yz-collapsed-preview"),t.find(".yz-shared-wrapper").append(e.data.show_all)),t.find("form").append('<input type="hidden" value="activity_share" name="post_type" />'),t.find("form").append('<input type="hidden" value="'+e.data.activity_id+'" name="secondary_item_id" />'),t.find(".yz-wall-options").remove(),"on"==e.posts_emojis&&(n=!1,jQuery().emojioneArea?t.find(".yz-wall-textarea").emojioneArea({pickerPosition:"bottom",autocomplete:!0,saveEmojisAs:"image",events:{ready:function(){this.editor.textcomplete([{id:"yz_mentions",match:/\B@([\-\d\w]*)$/,search:function(t,e){var a=bp.mentions.users;e(y.map(a,function(e){return 0===e.ID.indexOf(t)||0===e.name.indexOf(t)?e:null}))},template:function(e){return'<img src="'+e.image+'" /><span class="username">@'+e.ID+"</span><small>"+e.name+"</small>"},replace:function(e){return"@"+e.ID+"&nbsp;"},cache:!0,index:1}])}}}):(y("<script/>",{rel:"text/javascript",src:Youzer.assets+"js/emojionearea.min.js"}).appendTo("head"),y("<link/>",{rel:"stylesheet",href:Youzer.assets+"css/emojionearea.min.css"}).appendTo("head"))),t.find(".yz-wall-upload-btn").remove();var i=setInterval(function(){(1==n||0==n&&t.find(".emojionearea").get(0))&&(clearInterval(i),s.attr("data-loaded","true"),s.removeClass("loading"),y.yz_show_modal(t))},100)}).fail(function(e,t,a){return s.removeClass("loading"),y.yz_DialogMsg("error",Youzer.unknown_error),!1})}}}),y(document).on("click",".yz-show-all-less div",function(){var e=y(this).parent();e.hasClass("active")?(e.removeClass("active"),e.prev(".yz-shared-wrapper-container").addClass("yz-collapsed-preview")):(e.addClass("active"),e.prev(".yz-shared-wrapper-container").removeClass("yz-collapsed-preview"))})})}(jQuery);